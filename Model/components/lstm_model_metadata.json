{
  "model_name": "lstm_behavioral_malware_detector.h5",
  "training_date": "2025-11-08T14:16:32.617443",
  "dataset_path": "C:\\Users\\Admin\\github-classroom\\Caty175\\poly_trial\\dataset\\Malware_Analysis_kaggle.csv",
  "total_samples": 1308,
  "train_samples": 836,
  "val_samples": 210,
  "test_samples": 262,
  "feature_metadata": {
    "api_features": [
      "API_CoInitializeEx",
      "API_CoUninitialize",
      "API_NtResumeThread",
      "API_NtOpenFile",
      "API_CoCreateInstance",
      "API_CoInitializeSecurity",
      "API_NtDelayExecution",
      "API_NtCreateFile",
      "API_NtAllocateVirtualMemory",
      "API_LdrLoadDll",
      "API_OleInitialize",
      "API_CoGetClassObject",
      "API_NtWriteFile",
      "API_NtProtectVirtualMemory",
      "API_CreateProcessInternalW",
      "API_PRF",
      "API_NtDuplicateObject",
      "API_GetBestInterfaceEx",
      "API_LdrGetProcedureAddress",
      "API_WSAStartup",
      "API_GetSystemWindowsDirectoryW",
      "API_NtQueryValueKey",
      "API_NtMapViewOfSection",
      "API_GetFileSize",
      "API_InternetCloseHandle",
      "API_NtDeviceIoControlFile",
      "API_DeleteFileW",
      "API_NtOpenDirectoryObject",
      "API_NtReadFile",
      "API_InternetOpenUrlA",
      "API_FindFirstFileExW",
      "API_closesocket",
      "API_NtCreateMutant",
      "API_setsockopt",
      "API_LdrGetDllHandle",
      "API_NtCreateSection",
      "API_InternetSetOptionA",
      "API_NtOpenKey",
      "API_InternetOpenA",
      "API_socket",
      "API_NtClose",
      "API_LdrUnloadDll",
      "API_RegCloseKey",
      "API_RegQueryValueExA",
      "API_NtTerminateProcess",
      "API_RegOpenKeyExA",
      "API_RegSetValueExA",
      "API_RegCreateKeyExW",
      "API_GetNativeSystemInfo",
      "API_NtQueryKey",
      "API_HttpOpenRequestA",
      "API_getsockname",
      "API_GetAdaptersAddresses",
      "API_GetFileAttributesW",
      "API_RegQueryValueExW",
      "API_GetVolumePathNamesForVolumeNameW",
      "API_NtCreateThreadEx",
      "API_RegOpenKeyExW",
      "API_InternetConnectA",
      "API_GetFileInformationByHandle",
      "API_ShellExecuteExW",
      "API_NtQuerySystemInformation",
      "API_LoadStringW",
      "API_CreateThread",
      "API_InternetReadFile",
      "API_RegQueryInfoKeyW",
      "API_GetSystemDirectoryW",
      "API_RegDeleteValueW",
      "API_RegEnumKeyExW",
      "API_GetUserNameA",
      "API_GetTempPathW",
      "API_GetVolumeNameForVolumeMountPointW",
      "API_GetSystemTimeAsFileTime",
      "API_GetAddrInfoW",
      "API_HttpSendRequestA",
      "API_SetUnhandledExceptionFilter",
      "API_GetTimeZoneInformation",
      "API_CreateDirectoryW",
      "API_RegEnumValueA",
      "API_GetFileType",
      "API_RegSetValueExW",
      "API_InternetOpenW",
      "API_GetUserNameExW",
      "API_NtOpenSection",
      "API_GetForegroundWindow",
      "API_GetUserNameExA",
      "API_SetErrorMode",
      "API_GetCursorPos",
      "API_RegEnumValueW",
      "API_FindResourceExW",
      "API_GlobalMemoryStatusEx",
      "API_LoadResource",
      "API_GetKeyState",
      "API_DeviceIoControl",
      "API_RegCreateKeyExA",
      "API_CreateActCtxW",
      "API_SHGetFolderPathW",
      "API_UuidCreate",
      "API_CryptCreateHash",
      "API_GetSystemMetrics",
      "API_CryptProtectMemory",
      "API_GetFileSizeEx",
      "API_CryptAcquireContextW",
      "API_RegEnumKeyExA",
      "API_GetFileInformationByHandleEx",
      "API_NtOpenMutant",
      "API_DrawTextExW",
      "API_GetSystemInfo",
      "API_NtOpenProcess",
      "API_CryptHashData",
      "API_GetFileVersionInfoSizeExW",
      "API_SizeofResource",
      "API_RegEnumKeyW",
      "API_NtFreeVirtualMemory",
      "API_SetFilePointer",
      "API_NtUnmapViewOfSection",
      "API_NtQueryDirectoryFile",
      "API_NtQueryAttributesFile",
      "API_GetFileAttributesExW",
      "API_CreateToolhelp32Snapshot",
      "API_IsDebuggerPresent",
      "API_FindWindowA",
      "API_Process32NextW",
      "API_timeGetTime",
      "API___exception__",
      "API_GetSystemDirectoryA",
      "API_Process32FirstW",
      "API_NtOpenKeyEx",
      "API_OutputDebugStringA",
      "API_EnumWindows",
      "API_OpenServiceW",
      "API_NtReadVirtualMemory",
      "API_FindWindowW",
      "API_OpenSCManagerW",
      "API_FindResourceW",
      "API_NtOpenThread",
      "API_GetFileVersionInfoSizeW",
      "API_RtlRemoveVectoredExceptionHandler",
      "API_RtlAddVectoredExceptionHandler",
      "API_GetUserNameW",
      "API_NtSuspendThread",
      "API_NtQueryInformationFile",
      "API_OpenServiceA",
      "API_LookupPrivilegeValueW",
      "API_SetFilePointerEx",
      "API_NtSetValueKey",
      "API_recv",
      "API_GlobalMemoryStatus",
      "API_NtGetContextThread",
      "API_CryptExportKey",
      "API_NtEnumerateValueKey",
      "API_MoveFileWithProgressW",
      "API_ioctlsocket",
      "API_send",
      "API_ReadProcessMemory",
      "API_GetComputerNameW",
      "API_CryptAcquireContextA",
      "API_GetComputerNameA",
      "API_WSASocketW",
      "API_WSAConnect",
      "API_NetShareEnum",
      "API_GetFileVersionInfoW",
      "API_SHGetSpecialFolderLocation",
      "API_OpenSCManagerA",
      "API_SetEndOfFile",
      "API_FindWindowExW",
      "API_SetFileAttributesW",
      "API_SetFileTime",
      "API_WriteConsoleW",
      "API_NtSetInformationFile",
      "API_SendNotifyMessageW",
      "API_NtCreateKey",
      "API_SearchPathW",
      "API_NtEnumerateKey",
      "API_CreateRemoteThread",
      "API_WriteProcessMemory",
      "API_listen",
      "API_bind",
      "API_RemoveDirectoryW",
      "API_GetDiskFreeSpaceExW",
      "API_LoadStringA",
      "API_SetWindowsHookExA",
      "API_CopyFileA",
      "API_SetStdHandle",
      "API_gethostbyname",
      "API_GetAdaptersInfo",
      "API_GetShortPathNameW",
      "API_CopyFileW",
      "API_CreateJobObjectW",
      "API_SetInformationJobObject",
      "API_InternetQueryOptionA",
      "API_GetVolumePathNameW",
      "API_WSASocketA",
      "API_NtSetContextThread",
      "API_NtQueueApcThread",
      "API_RtlCreateUserThread",
      "API_WSASend",
      "API_CertOpenStore",
      "API_CryptDecodeObjectEx",
      "API_CertControlStore",
      "API_FindResourceA",
      "API_WSARecv",
      "API_connect",
      "API_NtDeleteValueKey",
      "API_InternetSetStatusCallback",
      "API_GetFileVersionInfoExW",
      "API_DecryptMessage",
      "API_EncryptMessage",
      "API_SetFileInformationByHandle",
      "API_HttpSendRequestW",
      "API_InternetCrackUrlW",
      "API_HttpOpenRequestW",
      "API_InternetConnectW",
      "API_HttpQueryInfoA",
      "API_RemoveDirectoryA",
      "API_SendNotifyMessageA",
      "API_GetSystemWindowsDirectoryA",
      "API_select",
      "API_WriteConsoleA",
      "API_MessageBoxTimeoutA",
      "API_GetAsyncKeyState",
      "API_SetWindowsHookExW",
      "API_RegDeleteKeyW",
      "API_UnhookWindowsHookEx",
      "API_LookupAccountSidW",
      "API_accept",
      "API_GetDiskFreeSpaceW",
      "API_NetGetJoinInformation",
      "API_RegDeleteValueA",
      "API_shutdown",
      "API_InternetGetConnectedState",
      "API_RegQueryInfoKeyA",
      "API_getaddrinfo",
      "API_CreateServiceA",
      "API_CoCreateInstanceEx",
      "API_IWbemServices_ExecQuery",
      "API_CryptGenKey",
      "API_FindResourceExA",
      "API_CryptEncrypt",
      "API_InternetOpenUrlW",
      "API_DeleteUrlCacheEntryW",
      "API_StartServiceA",
      "API_DrawTextExA",
      "API_RtlDecompressBuffer",
      "API_IWbemServices_ExecMethod",
      "API_ObtainUserAgentString",
      "API_InternetCrackUrlA",
      "API_DnsQuery_A",
      "API_CryptDecrypt",
      "API_Module32FirstW",
      "API_Module32NextW",
      "API_ControlService",
      "API_CertOpenSystemStoreA",
      "API_JsGlobalObjectDefaultEvalHelper",
      "API_Thread32Next",
      "API_Thread32First",
      "API_DeleteUrlCacheEntryA",
      "API_RtlAddVectoredContinueHandler",
      "API_RegDeleteKeyA",
      "API_EnumServicesStatusA",
      "API_FindFirstFileExA"
    ],
    "static_features": [
      "file_deleted",
      "file_created",
      "file_read",
      "file_written",
      "dll_freq_kernel32.dll",
      "dll_freq_oleaut32.dll",
      "dll_freq_advapi32.dll",
      "dll_freq_shell32.dll",
      "dll_freq_user32.dll",
      "dll_freq_ole32.dll",
      "dll_freq_comctl32.dll",
      "dll_freq_rpcrt4.dll",
      "dll_freq_cryptsp.dll",
      "dll_freq_setupapi.dll",
      "dll_freq_ntdll.dll",
      "dll_freq_cryptbase.dll",
      "dll_freq_dwmapi.dll",
      "dll_freq_uxtheme.dll",
      "dll_freq_gdi32.dll",
      "dll_freq_c:\\windows\\system32\\ole32.dll",
      "dll_freq_ws2_32.dll",
      "dll_freq_secur32.dll",
      "dll_freq_iphlpapi.dll",
      "dll_freq_shlwapi.dll",
      "dll_freq_urlmon.dll",
      "dll_freq_winhttp.dll",
      "dll_freq_wininet.dll",
      "dll_freq_api-ms-win-core-localregistry-l1-1-0.dll",
      "dll_freq_c:\\windows\\system32\\mswsock.dll",
      "dll_freq_propsys.dll",
      "dll_freq_dwrite.dll",
      "dll_freq_sxs.dll",
      "dll_freq_apphelp.dll",
      "dll_freq_imm32.dll",
      "dll_freq_api-ms-win-security-sddl-l1-1-0.dll",
      "dll_freq_dnsapi.dll",
      "dll_freq_profapi.dll",
      "dll_freq_api-ms-win-downlevel-advapi32-l2-1-0.dll",
      "dll_freq_c:\\windows\\syswow64\\oleaut32.dll",
      "dll_freq_c:\\windows\\system32\\rsaenh.dll",
      "dll_freq_rpcrtremote.dll",
      "dll_freq_api-ms-win-downlevel-ole32-l1-1-0.dll",
      "dll_freq_api-ms-win-downlevel-shlwapi-l2-1-0.dll",
      "dll_freq_api-ms-win-downlevel-advapi32-l1-1-0.dll",
      "dll_freq_api-ms-win-downlevel-shlwapi-l1-1-0.dll",
      "dll_freq_windowscodecs.dll",
      "dll_freq_wintrust.dll",
      "dll_freq_version.dll",
      "dll_freq_comdlg32.dll",
      "dll_freq_mshtml.dll",
      "dll_freq_c:\\windows\\system32\\uxtheme.dll",
      "dll_freq_crypt32.dll",
      "dll_freq_mpr.dll",
      "dll_freq_c:\\windows\\system32\\oleaut32.dll",
      "regkey_read",
      "directory_enumerated",
      "dll_loaded_count",
      "resolves_host",
      "command_line"
    ],
    "num_api_features": 261,
    "num_static_features": 59,
    "label_threshold": 5.0
  },
  "hyperparameters": {
    "lstm_units": 128,
    "lstm_dropout": 0.3,
    "dense_units": 256,
    "dense_dropout": 0.4,
    "learning_rate": 0.001,
    "batch_size": 32,
    "epochs": 50,
    "patience": 10
  },
  "metrics": {
    "accuracy": 0.7786259541984732,
    "roc_auc": 0.8514698909435752,
    "confusion_matrix": [
      [
        106,
        8
      ],
      [
        50,
        98
      ]
    ],
    "true_positives": 98,
    "true_negatives": 106,
    "false_positives": 8,
    "false_negatives": 50
  },
  "training_history": {
    "final_epoch": 24,
    "final_train_loss": 0.34890273213386536,
    "final_val_loss": 0.5884332656860352,
    "final_train_accuracy": 0.8193780183792114,
    "final_val_accuracy": 0.6857143044471741,
    "best_val_auc": 0.8400423526763916
  }
}